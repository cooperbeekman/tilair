<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tilair</title>
    <style>
        @import url('https://fonts.googleapis.com/css?family=Raleway:900&display=swap');

        * {
            margin: 0;
            padding: 0;
        }

        body {
            background: #fff;
            overflow: hidden;
        }

        canvas {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        const texts = ["...", "..", ".", "Tilair", "Is", "A", "Holding", "Company", "/", "Venture", "Studio", "Based", "In", "Puerto Rico ðŸ‡µðŸ‡·", "That", "Builds", "and", "Invests", "In", "Crypto", "AI", "Health Tech", "Online Education", "Defense Tech", "For", "All", "Inquiries", "Email", "cole", "@", "tilair.com"];

        const morphTime = 1;
        const cooldownTime = 0.25;

        let textIndex = texts.length - 1;
        let time = new Date();
        let morph = 0;
        let cooldown = cooldownTime;

        // Set canvas size
        function resize() {
            canvas.width = window.innerWidth * 2;
            canvas.height = window.innerHeight * 2;
            canvas.style.width = window.innerWidth + 'px';
            canvas.style.height = window.innerHeight + 'px';
        }
        resize();
        window.addEventListener('resize', resize);

        function getFontSize() {
            const baseSize = Math.min(window.innerWidth, window.innerHeight);
            return Math.max(baseSize * 0.15, 40) * 2; // *2 for retina
        }

        function doMorph() {
            morph -= cooldown;
            cooldown = 0;

            let fraction = morph / morphTime;

            if (fraction > 1) {
                cooldown = cooldownTime;
                fraction = 1;
            }

            return fraction;
        }

        function doCooldown() {
            morph = 0;
            return 1; // fraction = 1 means text2 is fully visible
        }

        function drawText(text, opacity, blur) {
            ctx.save();
            ctx.globalAlpha = opacity;
            if (blur > 0.5) {
                ctx.filter = `blur(${blur}px)`;
            }
            ctx.fillText(text, canvas.width / 2, canvas.height / 2);
            ctx.restore();
        }

        function render(fraction) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const fontSize = getFontSize();
            ctx.font = `900 ${fontSize}px Raleway, sans-serif`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillStyle = '#000';

            const text1 = texts[textIndex % texts.length];
            const text2 = texts[(textIndex + 1) % texts.length];

            // Calculate blur and opacity for each text
            const blur2 = Math.min(12 / fraction - 12, 100);
            const opacity2 = Math.pow(fraction, 0.4);

            const blur1 = Math.min(12 / (1 - fraction) - 12, 100);
            const opacity1 = Math.pow(1 - fraction, 0.4);

            // Draw text1 (fading out)
            if (opacity1 > 0.01) {
                drawText(text1, opacity1, Math.min(blur1, 50));
            }

            // Draw text2 (fading in)
            if (opacity2 > 0.01) {
                drawText(text2, opacity2, Math.min(blur2, 50));
            }

            // Apply threshold effect by redrawing with contrast
            applyThreshold();
        }

        function applyThreshold() {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            const threshold = 100;

            for (let i = 0; i < data.length; i += 4) {
                // Get alpha value
                const a = data[i + 3];

                // Apply threshold to alpha
                if (a > threshold) {
                    data[i + 3] = 255; // Full opacity
                } else {
                    // Scale alpha more aggressively for gooey effect
                    data[i + 3] = Math.max(0, (a - threshold * 0.4) * 2.5);
                }
            }

            ctx.putImageData(imageData, 0, 0);
        }

        function animate() {
            requestAnimationFrame(animate);

            let newTime = new Date();
            let shouldIncrementIndex = cooldown > 0;
            let dt = (newTime - time) / 1000;
            time = newTime;

            cooldown -= dt;

            let fraction;
            if (cooldown <= 0) {
                if (shouldIncrementIndex) {
                    textIndex++;
                }
                fraction = doMorph();
            } else {
                fraction = doCooldown();
            }

            render(fraction);
        }

        // Wait for font to load
        document.fonts.ready.then(() => {
            animate();
        });
    </script>
</body>
</html>
